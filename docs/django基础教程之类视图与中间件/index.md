# Django基础教程之类视图与中间件


**声明：以下内容均为我个人的理解，如果发现错误或者疑问可以联系我共同探讨**

本教程为Django基础教程系列第五篇，前面篇章在以下链接：

[Django基础教程之Django介绍](http://49.235.231.121/2019/django基础教程一/)

[Django基础教程之工程搭建](http://49.235.231.121/2019/django基础教程二/)

[Django基础教程之配置文件详解](http://49.235.231.121/2019/django基础教程三/)

[Django基础教程之请求与响应](http://49.235.231.121/2019/django基础教程四/)

## 类视图

以函数的方式定义的视图称为**函数视图**，函数视图便于理解。但是遇到一个视图对应的路径提供了多种不同HTTP请求方式的支持时，便需要在一个函数中编写不同的业务逻辑，代码可读性与复用性都不佳。

在Django中也可以使用类来定义一个视图，称为**类视图**。使用类视图可以将视图对应的不同请求方式以类中的不同方法来区别定义。



#### 类视图的好处

- **代码可读性好**
- **类视图相对于函数视图有更高的复用性**， 如果其他地方需要用到某个类视图的某个特定逻辑，直接继承该类视图即可



####  类视图使用

定义类视图需要继承自Django提供的父类**View**，可使用`from django.views.generic import View`或者`from django.views.generic.base import View` 导入

**配置路由时，使用类视图的`as_view()`方法来添加**。



### 类视图原理



#### 类视图使用装饰器

#### 类视图Mixin扩展类



## 中间件

Django中的中间件是一个轻量级、底层的插件系统，可以介入Django的请求和响应处理过程，修改Django的输入或输出。中间件的设计为开发者提供了一种无侵入式的开发方式，增强了Django框架的健壮性。

我们可以使用中间件，在Django处理视图的不同阶段对输入或输出进行干预。

### 中间件的定义方法

定义一个中间件工厂函数，然后返回一个可以别调用的中间件。

中间件工厂函数需要接收一个可以调用的get_response对象。

返回的中间件也是一个可以被调用的对象，并且像视图一样需要接收一个request对象参数，返回一个response对象。

**定义好中间件后，需要在settings.py 文件中添加注册中间件**

### 多个中间件的执行顺序

- 在请求视图被处理**前**，中间件**由上至下**依次执行
- 在请求视图被处理**后**，中间件**由下至上**依次执行
