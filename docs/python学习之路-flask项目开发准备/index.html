<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Python学习之路-Flask项目:开发准备 - Silence Blog</title><meta name="Description" content="Silence‘s blog"><meta property="og:title" content="Python学习之路-Flask项目:开发准备" />
<meta property="og:description" content="前面几篇学习了Flask的基础知识，从今天开始开发一个个人博客项目来练练手。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://silencehuliang.github.io/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-flask%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/" />
<meta property="og:image" content="https://tva1.sinaimg.cn/large/00729CCqgy1gp1qfrpi14j305k05k745.jpg"/>
<meta property="article:published_time" content="2020-06-13T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-06-14T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://tva1.sinaimg.cn/large/00729CCqgy1gp1qfrpi14j305k05k745.jpg"/>

<meta name="twitter:title" content="Python学习之路-Flask项目:开发准备"/>
<meta name="twitter:description" content="前面几篇学习了Flask的基础知识，从今天开始开发一个个人博客项目来练练手。"/>
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://silencehuliang.github.io/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-flask%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/" /><link rel="prev" href="https://silencehuliang.github.io/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-%E6%B7%B1%E6%8B%B7%E8%B4%9D%E4%B8%8E%E6%B5%85%E6%8B%B7%E8%B4%9D/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.2e7125082ec8de83a87adc70253c9c23.css" integrity="md5-LnElCC7I3oOoetxwJTycIw=="><link rel="stylesheet" href="/css/style.min.f03a2ec71b16efbe4f24352e542c93a9.css" integrity="md5-8DouxxsW775PJDUuVCyTqQ=="><link rel="stylesheet" href="/lib/fontawesome-free/all.min.76cb46c10b6c0293433b371bae2414b2.css" integrity="md5-dstGwQtsApNDOzcbriQUsg=="><link rel="stylesheet" href="/lib/animate/animate.min.bc1a6a99c43f5ccc97d2d350bde13f74.css" integrity="md5-vBpqmcQ/XMyX0tNQveE/dA=="><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Python学习之路-Flask项目:开发准备",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/silencehuliang.github.io\/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-flask%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87\/"
        },"genre": "posts","keywords": "Python学习之路","wordcount":  6582 ,
        "url": "https:\/\/silencehuliang.github.io\/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-flask%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87\/","datePublished": "2020-06-13T00:00:00+00:00","dateModified": "2020-06-14T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": "Silence"},"author": {
                "@type": "Person",
                "name": "Silence"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Silence Blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="https://tva1.sinaimg.cn/large/00729CCqgy1gp1qfrpi14j305k05k745.jpg"
        data-srcset="https://tva1.sinaimg.cn/large/00729CCqgy1gp1qfrpi14j305k05k745.jpg, https://tva1.sinaimg.cn/large/00729CCqgy1gp1qfrpi14j305k05k745.jpg 1.5x, https://tva1.sinaimg.cn/large/00729CCqgy1gp1qfrpi14j305k05k745.jpg 2x"
        data-sizes="auto"
        alt="https://tva1.sinaimg.cn/large/00729CCqgy1gp1qfrpi14j305k05k745.jpg"
        title="https://tva1.sinaimg.cn/large/00729CCqgy1gp1qfrpi14j305k05k745.jpg" /><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/about/"> 关于 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Silence Blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="https://tva1.sinaimg.cn/large/00729CCqgy1gp1qfrpi14j305k05k745.jpg"
        data-srcset="https://tva1.sinaimg.cn/large/00729CCqgy1gp1qfrpi14j305k05k745.jpg, https://tva1.sinaimg.cn/large/00729CCqgy1gp1qfrpi14j305k05k745.jpg 1.5x, https://tva1.sinaimg.cn/large/00729CCqgy1gp1qfrpi14j305k05k745.jpg 2x"
        data-sizes="auto"
        alt="https://tva1.sinaimg.cn/large/00729CCqgy1gp1qfrpi14j305k05k745.jpg"
        title="https://tva1.sinaimg.cn/large/00729CCqgy1gp1qfrpi14j305k05k745.jpg" /><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/about/" title="">关于</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Python学习之路-Flask项目:开发准备</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Silence</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/python/"><i class="far fa-folder fa-fw"></i>Python</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2020-06-13">2020-06-13</time>&nbsp;<i class="fa fa-history" aria-hidden="true"></i>
                2020-06-14
                <i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 6582 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 14 分钟&nbsp;<span id="/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-flask%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/" class="leancloud_visitors" data-flag-title="Python学习之路-Flask项目:开发准备">
                        <i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;次阅读
                    </span>&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#前言">前言</a></li>
    <li><a href="#项目分析">项目分析</a>
      <ul>
        <li><a href="#技术实现">技术实现</a></li>
        <li><a href="#功能模块">功能模块</a></li>
        <li><a href="#具体需求">具体需求</a></li>
      </ul>
    </li>
    <li><a href="#项目框架搭建">项目框架搭建</a>
      <ul>
        <li><a href="#创建项目">创建项目</a></li>
        <li><a href="#使用-git-管理源代码">使用 GIT 管理源代码</a>
          <ul>
            <li><a href="#本地提交">本地提交</a></li>
            <li><a href="#远程提交">远程提交</a></li>
          </ul>
        </li>
        <li><a href="#项目基本配置">项目基本配置</a>
          <ul>
            <li><a href="#config类">Config类</a></li>
            <li><a href="#sqlalchemy">SQLAlchemy</a></li>
            <li><a href="#redis">Redis</a></li>
            <li><a href="#csrf">CSRF</a></li>
            <li><a href="#session">Session</a></li>
            <li><a href="#flask-script与数据库迁移扩展">Flask-Script与数据库迁移扩展</a></li>
          </ul>
        </li>
        <li><a href="#代码抽取">代码抽取</a>
          <ul>
            <li><a href="#目标">目标</a></li>
            <li><a href="#配置文件">配置文件</a></li>
            <li><a href="#业务逻辑独立">业务逻辑独立</a></li>
            <li><a href="#项目多种配置">项目多种配置</a></li>
            <li><a href="#工厂类方法">工厂类方法</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#日志">日志</a>
      <ul>
        <li><a href="#简介">简介</a></li>
        <li><a href="#作用">作用</a></li>
        <li><a href="#等级">等级</a></li>
        <li><a href="#字段信息与日志格式">字段信息与日志格式</a></li>
        <li><a href="#功能的实现">功能的实现</a>
          <ul>
            <li><a href="#logging-模块">logging 模块</a>
              <ul>
                <li><a href="#简介-1">简介</a></li>
                <li><a href="#日志级别">日志级别</a></li>
                <li><a href="#使用方式介绍">使用方式介绍</a></li>
                <li><a href="#函数记录">函数记录</a>
                  <ul>
                    <li><a href="#最简单的日志输出">最简单的日志输出</a></li>
                    <li><a href="#修改配置改变输出内容">修改配置改变输出内容</a></li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#集成日志到当前项目">集成日志到当前项目</a></li>
      </ul>
    </li>
    <li><a href="#蓝图">蓝图</a></li>
    <li><a href="#数据库表">数据库表</a>
      <ul>
        <li><a href="#分析">分析</a></li>
        <li><a href="#数据库表迁移">数据库表迁移</a></li>
        <li><a href="#测试数据的添加">测试数据的添加</a></li>
      </ul>
    </li>
    <li><a href="#静态文件导入">静态文件导入</a></li>
    <li><a href="#注册根路由">注册根路由</a>
      <ul>
        <li><a href="#创建模板目录">创建模板目录</a></li>
        <li><a href="#添加模板并创建根路由视图函数">添加模板并创建根路由视图函数</a></li>
      </ul>
    </li>
    <li><a href="#网站图标展示">网站图标展示</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="前言">前言</h2>
<p>前面几篇学习了<code>Flask</code>的基础知识，从今天开始开发一个个人博客项目来练练手。</p>
<h2 id="项目分析">项目分析</h2>
<ul>
<li>关于个人博客的Web项目，主要为自己提供一个记录与技术输出的平台。</li>
<li>以个人编写或者转载优秀的文章作为博文的主要来源</li>
<li>基于 Flask 框架，以 <strong>前后端不分离</strong> 的形式实现具体业务逻辑</li>
</ul>
<h3 id="技术实现">技术实现</h3>
<ul>
<li>基于<code>Python 3.7.7</code> + <code>Flask</code>框架实现</li>
<li>数据存储使用<code>Redis</code> + <code>MySQL</code> 实现</li>
<li>第三方扩展：七牛云(文件存储平台)</li>
<li>布署：基于macOS 10.15.4系统，使用 Gunicorn + Nginx 进行布署</li>
</ul>
<h3 id="功能模块">功能模块</h3>
<ul>
<li>博客模块
<ul>
<li>首页博客列表</li>
<li>博客详情</li>
</ul>
</li>
<li>关于模块
<ul>
<li>个人信息展示</li>
</ul>
</li>
<li>联系模块
<ul>
<li>联系我功能</li>
</ul>
</li>
<li>后台管理
<ul>
<li>博文的管理</li>
<li>访问数据统计</li>
</ul>
</li>
</ul>
<h3 id="具体需求">具体需求</h3>
<ol>
<li>首页
<ul>
<li>根据近期文章列表展示</li>
<li>翻页加载更多数据</li>
<li>点击新窗口跳转到文章详情页</li>
<li>顶部显示博客各大版块</li>
<li>右侧显示最新文章、归档、分类、标签云与RSS订阅相关信息</li>
</ul>
</li>
<li>文章详情
<ul>
<li>文章内容 html 数据展示</li>
<li>可以评论该文章</li>
<li>右侧显示文章目录、最新文章、归档、分类、标签云与RSS订阅</li>
</ul>
</li>
<li>关于页
<ul>
<li>展示作者相关信息</li>
</ul>
</li>
<li>联系页
<ul>
<li>填写相关信息提供联系作者功能</li>
</ul>
</li>
<li>后台-登录
<ul>
<li>提供后台登录页面</li>
</ul>
</li>
<li>后台-用户统计
<ul>
<li>登录到后台界面之后展示用户统计界面</li>
<li>显示各类用户访问数据</li>
<li>展示当前月访问新增人数</li>
<li>展示当前日访问新增人数</li>
</ul>
</li>
<li>后台-发布文章
<ul>
<li>提供<code>markdown</code>编辑器进行文章实时预览</li>
<li>发布文章</li>
<li>草稿文章</li>
</ul>
</li>
<li>文章信息展示
<ul>
<li>进入默认展示所有文章数据</li>
<li>可以根据文章标题搜索文章</li>
</ul>
</li>
<li>文章分类管理
<ul>
<li>展示所有分类列表</li>
<li>可以添加/修改分类</li>
</ul>
</li>
</ol>
<h2 id="项目框架搭建">项目框架搭建</h2>
<h3 id="创建项目">创建项目</h3>
<ul>
<li>
<p>新建项目，虚拟环境选择python3版本，创建 <code>manage.py</code> 文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello_world</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">&#39;Hello World!&#39;</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="使用-git-管理源代码">使用 GIT 管理源代码</h3>
<p>git相关内容可以查看之前的<a href="https://learnku.com/articles/56481" target="_blank" rel="noopener noreffer">相关文章</a></p>
<h4 id="本地提交">本地提交</h4>
<ul>
<li>
<p>初始化<code>git</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">Desktop % <span class="nb">cd</span> flaskblog 
flaskblog % git init
Initialized empty Git repository in /Users/huliang/Desktop/flaskblog/.git/
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>配置当前项目<code>git</code>提交信息(可省略此步，如不配置则使用全局配置)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">flaskblog % git config user.email xxx@xxx.com
flaskblog % git config user.name xxxx
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>添加忽略文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">flaskblog % touch .gitignore
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>设置忽略文件内容(后续根据需要再添加)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">.idea
*.py<span class="o">[</span>cod<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>添加所有文件到暂存区</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">flaskblog % git add .
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>提交到本地仓库并填写注释</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">flaskblog % git commit -m<span class="s1">&#39;初次提交&#39;</span>  
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h4 id="远程提交">远程提交</h4>
<p>使用<code>GitHub</code>：https://github.com/ 作为在线 git 源代码仓库</p>
<ul>
<li>
<p>在GitHub上创建名为flaskblog的仓库</p>
</li>
<li>
<p>创建完成后将本地项目提交至仓库中</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">flaskblog % <span class="nb">cd</span> flaskblog
flaskblog % git remote add origin xxx/flaskblog.git
flaskblog % git push -u origin master
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="项目基本配置">项目基本配置</h3>
<h4 id="config类">Config类</h4>
<p>先在当前类中定义配置的类，并从中加载配置</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">...</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Config</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s2">&#34;&#34;&#34;工程配置信息&#34;&#34;&#34;</span>
    <span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">True</span>


<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">Config</span><span class="p">)</span>
<span class="o">...</span>
</code></pre></td></tr></table>
</div>
</div><p>运行测试</p>
<h4 id="sqlalchemy">SQLAlchemy</h4>
<ul>
<li>
<p>导入数据库扩展，并在配置中填写相关配置</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask_sqlalchemy</span> <span class="kn">import</span> <span class="n">SQLAlchemy</span>

<span class="o">...</span>

<span class="k">class</span> <span class="nc">Config</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s2">&#34;&#34;&#34;工程配置信息&#34;&#34;&#34;</span>
    <span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="c1"># 数据库的配置信息</span>
    <span class="n">SQLALCHEMY_DATABASE_URI</span> <span class="o">=</span> <span class="s2">&#34;mysql://root:mysql@127.0.0.1:3306/flaskblog&#34;</span>
    <span class="n">SQLALCHEMY_TRACK_MODIFICATIONS</span> <span class="o">=</span> <span class="bp">False</span>

<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">Config</span><span class="p">)</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">SQLAlchemy</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在终端创建数据库</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">mysql&gt; create database flaskblog charset utf8<span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>运行测试</p>
</li>
</ul>
<h4 id="redis">Redis</h4>
<p>创建redis存储对象，并在配置中填写相关配置</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">redis</span>
<span class="o">...</span>

<span class="k">class</span> <span class="nc">Config</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s2">&#34;&#34;&#34;工程配置信息&#34;&#34;&#34;</span>
    <span class="o">...</span>
    <span class="c1"># redis配置</span>
    <span class="n">REDIS_HOST</span> <span class="o">=</span> <span class="s2">&#34;127.0.0.1&#34;</span>
    <span class="n">REDIS_PORT</span> <span class="o">=</span> <span class="mi">6379</span>

<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">Config</span><span class="p">)</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">SQLAlchemy</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<span class="n">redis_store</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">StrictRedis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">Config</span><span class="o">.</span><span class="n">REDIS_HOST</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">Config</span><span class="o">.</span><span class="n">REDIS_PORT</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>运行测试</p>
<h4 id="csrf">CSRF</h4>
<p>包含请求体的请求都需要开启CSRF</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask_wtf.csrf</span> <span class="kn">import</span> <span class="n">CSRFProtect</span>
<span class="o">...</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">Config</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">CSRFProtect</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>CSRFProtect只做验证工作，cookie中的 csrf_token 和表单中的 csrf_token 需要我们自己实现</p>
<h4 id="session">Session</h4>
<ul>
<li>
<p>利用 flask-session扩展，将 session 数据保存到 Redis 中</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask_session</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="o">...</span>

<span class="k">class</span> <span class="nc">Config</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s2">&#34;&#34;&#34;工程配置信息&#34;&#34;&#34;</span>
    <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s2">&#34;EjpNVSNQTyGi1VvWECj9TvC/+kq3oujee2kTfQUs8yCM6xX9Yjq52v54g+HVoknA&#34;</span>
    <span class="o">...</span>
    <span class="c1"># flask_session的配置信息</span>
    <span class="n">SESSION_TYPE</span> <span class="o">=</span> <span class="s2">&#34;redis&#34;</span> <span class="c1"># 指定 session 保存到 redis 中</span>
    <span class="n">SESSION_USE_SIGNER</span> <span class="o">=</span> <span class="bp">True</span> <span class="c1"># 让 cookie 中的 session_id 被加密签名处理</span>
    <span class="n">SESSION_REDIS</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">StrictRedis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">REDIS_HOST</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">REDIS_PORT</span><span class="p">)</span> <span class="c1"># 使用 redis 的实例</span>
    <span class="n">PERMANENT_SESSION_LIFETIME</span> <span class="o">=</span> <span class="mi">86400</span> <span class="c1"># session 的有效期，单位是秒</span>

<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">Config</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">Session</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>运行测试</p>
<h4 id="flask-script与数据库迁移扩展">Flask-Script与数据库迁移扩展</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask_script</span> <span class="kn">import</span> <span class="n">Manager</span>
<span class="kn">from</span> <span class="nn">flask_migrate</span> <span class="kn">import</span> <span class="n">Migrate</span><span class="p">,</span> <span class="n">MigrateCommand</span>
<span class="o">...</span>
<span class="n">manager</span> <span class="o">=</span> <span class="n">Manager</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<span class="n">Migrate</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>
<span class="n">manager</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="s1">&#39;db&#39;</span><span class="p">,</span> <span class="n">MigrateCommand</span><span class="p">)</span>
<span class="o">...</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">manager</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>运行测试</p>
<h3 id="代码抽取">代码抽取</h3>
<h4 id="目标">目标</h4>
<p>将特定逻辑代码抽取到指定的类中，各司其职，放便后续项目维护</p>
<h4 id="配置文件">配置文件</h4>
<ul>
<li>
<p>在与 <code>manage.py</code> 同级目录下创建 <code>config.py</code> 文件，用作于项目的配置文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">redis</span>

<span class="k">class</span> <span class="nc">Config</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s2">&#34;&#34;&#34;工程配置信息&#34;&#34;&#34;</span>
    <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s2">&#34;EjpNVSNQTyGi1VvWECj9TvC/+kq3oujee2kTfQUs8yCM6xX9Yjq52v54g+HVoknA&#34;</span>

    <span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">True</span>
    
    <span class="c1"># 数据库的配置信息</span>
    <span class="n">SQLALCHEMY_DATABASE_URI</span> <span class="o">=</span> <span class="s2">&#34;mysql://root:mysql@127.0.0.1:3306/flaskblog&#34;</span>
    <span class="n">SQLALCHEMY_TRACK_MODIFICATIONS</span> <span class="o">=</span> <span class="bp">True</span>
    
    <span class="c1"># redis配置</span>
    <span class="n">REDIS_HOST</span> <span class="o">=</span> <span class="s2">&#34;127.0.0.1&#34;</span>
    <span class="n">REDIS_PORT</span> <span class="o">=</span> <span class="mi">6379</span>
    
    <span class="c1"># session 配置</span>
    <span class="n">SESSION_TYPE</span> <span class="o">=</span> <span class="s2">&#34;redis&#34;</span>  <span class="c1"># 指定 session 保存到 redis 中</span>
    <span class="n">SESSION_USE_SIGNER</span> <span class="o">=</span> <span class="bp">True</span>  <span class="c1"># 让 cookie 中的 session_id 被加密签名处理</span>
    <span class="n">SESSION_REDIS</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">StrictRedis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">REDIS_HOST</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">REDIS_PORT</span><span class="p">)</span>  <span class="c1"># 使用 redis 的实例</span>
    <span class="n">PERMANENT_SESSION_LIFETIME</span> <span class="o">=</span> <span class="mi">86400</span>  <span class="c1"># session 的有效期，单位是秒</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在 <code>manager.py</code> 中引入 <code>Config</code> 类，直接使用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">config</span> <span class="kn">import</span> <span class="n">Config</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># 配置</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">Config</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>运行测试</p>
</li>
</ul>
<h4 id="业务逻辑独立">业务逻辑独立</h4>
<p>在整个项目文件夹中，除了启动文件 <code>manage.py</code> 和配置文件 <code>config.py</code> 放在根目录，其他具体业务逻辑文件都放在一个单独的文件夹内，与 <code>manage.py</code> 同级</p>
<ul>
<li>
<p>创建 <code>blog</code> Package，与 <code>manage.py</code> 同级</p>
</li>
<li>
<p><code>manage.py</code> 只做最基本的启动工作，将 <code>app</code> 的创建操作移动到 <code>blog</code> 的 <code>__init__.py</code> 文件中</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">redis</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask_sqlalchemy</span> <span class="kn">import</span> <span class="n">SQLAlchemy</span>
<span class="kn">from</span> <span class="nn">flask_wtf.csrf</span> <span class="kn">import</span> <span class="n">CSRFProtect</span>
<span class="kn">from</span> <span class="nn">flask_session</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="kn">from</span> <span class="nn">config</span> <span class="kn">import</span> <span class="n">Config</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># 配置</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">Config</span><span class="p">)</span>
<span class="c1"># 配置数据库</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">SQLAlchemy</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<span class="c1"># 配置redis</span>
<span class="n">redis_store</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">StrictRedis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">Config</span><span class="o">.</span><span class="n">REDIS_HOST</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">Config</span><span class="o">.</span><span class="n">REDIS_PORT</span><span class="p">)</span>
<span class="c1"># 开启csrf保护</span>
<span class="n">CSRFProtect</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<span class="c1"># 设置session保存位置</span>
<span class="n">Session</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><code>manage.py</code> 的代码为</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask_script</span> <span class="kn">import</span> <span class="n">Manager</span>
<span class="kn">from</span> <span class="nn">flask_migrate</span> <span class="kn">import</span> <span class="n">Migrate</span><span class="p">,</span> <span class="n">MigrateCommand</span>
<span class="kn">from</span> <span class="nn">blog</span> <span class="kn">import</span> <span class="n">app</span><span class="p">,</span> <span class="n">db</span>

<span class="c1"># Flask-script</span>
<span class="n">manager</span> <span class="o">=</span> <span class="n">Manager</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<span class="c1"># 数据库迁移</span>
<span class="n">Migrate</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>
<span class="n">manager</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="s1">&#39;db&#39;</span><span class="p">,</span> <span class="n">MigrateCommand</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/index&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
  <span class="k">return</span> <span class="s1">&#39;index&#39;</span>

  
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">manager</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>运行测试</p>
</li>
</ul>
<h4 id="项目多种配置">项目多种配置</h4>
<p>一个web程序在开发阶段可能与生产阶段所需要的配置信息可能不一样，所以为了实现此功能，可以给不同情况创建不同的配置类，比如开发阶段使用的配置类名为 <code>DevelopementConfig</code>，生产阶段使用的配置类名为 <code>ProdutionConfig</code>，修改 <code>config.py</code> 文件的配置文件如下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">redis</span>


<span class="k">class</span> <span class="nc">Config</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s2">&#34;&#34;&#34;工程配置信息&#34;&#34;&#34;</span>

    <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s2">&#34;EjpNVSNQTyGi1VvWECj9TvC/+kq3oujee2kTfQUs8yCM6xX9Yjq52v54g+HVoknA&#34;</span>

    <span class="c1"># 数据库的配置信息</span>
    <span class="n">SQLALCHEMY_DATABASE_URI</span> <span class="o">=</span> <span class="s2">&#34;mysql://root:mysql@127.0.0.1:3306/flaskblog&#34;</span>
    <span class="n">SQLALCHEMY_TRACK_MODIFICATIONS</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="c1"># redis配置</span>
    <span class="n">REDIS_HOST</span> <span class="o">=</span> <span class="s2">&#34;127.0.0.1&#34;</span>
    <span class="n">REDIS_PORT</span> <span class="o">=</span> <span class="mi">6379</span>

    <span class="c1"># flask_session的配置信息</span>
    <span class="n">SESSION_TYPE</span> <span class="o">=</span> <span class="s2">&#34;redis&#34;</span>  <span class="c1"># 指定 session 保存到 redis 中</span>
    <span class="n">SESSION_USE_SIGNER</span> <span class="o">=</span> <span class="bp">True</span>  <span class="c1"># 让 cookie 中的 session_id 被加密签名处理</span>
    <span class="n">SESSION_REDIS</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">StrictRedis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">REDIS_HOST</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">REDIS_PORT</span><span class="p">)</span>  <span class="c1"># 使用 redis 的实例</span>
    <span class="n">PERMANENT_SESSION_LIFETIME</span> <span class="o">=</span> <span class="mi">86400</span>  <span class="c1"># session 的有效期，单位是秒</span>


<span class="k">class</span> <span class="nc">DevelopementConfig</span><span class="p">(</span><span class="n">Config</span><span class="p">):</span>
    <span class="s2">&#34;&#34;&#34;开发模式下的配置&#34;&#34;&#34;</span>
    <span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">True</span>


<span class="k">class</span> <span class="nc">ProductionConfig</span><span class="p">(</span><span class="n">Config</span><span class="p">):</span>
    <span class="s2">&#34;&#34;&#34;生产模式下的配置&#34;&#34;&#34;</span>
    <span class="k">pass</span>
</code></pre></td></tr></table>
</div>
</div><p>接下来思考如何能才更快速的针对不同的布署环境去使用不同的配置</p>
<h4 id="工厂类方法">工厂类方法</h4>
<p>要在不同环境下去使用不同的配置，那么可以在 <code>manage.py</code> 文件中给 <code>blog</code> 包传入不同的配置信息，让 ihome 去根据传入指定配置去创建 <code>app</code>，所以可以在 <code>blog</code> 的 <code>__init__.py</code> 文件中添加一个工厂方法，根据传入的配置不同创建其对应的应用实例</p>
<ul>
<li>
<p>在 <code>config.py</code> 文件中添加以下代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback"># 定义配置字典
config = {
    &#34;development&#34;: DevelopementConfig,
    &#34;production&#34;: ProductionConfig
}
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>修改 <code>blog</code> 文件夹下 <code>__init__.py</code>，添加 <code>create_app</code> 的工厂方法</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">create_app</span><span class="p">(</span><span class="n">config_name</span><span class="p">):</span>
    <span class="s2">&#34;&#34;&#34;通过传入不同的配置名字，初始化其对应配置的应用实例&#34;&#34;&#34;</span>
    <span class="k">pass</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>修改 <code>manage.py</code> 文件中的代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">blog</span> <span class="kn">import</span> <span class="n">create_app</span><span class="p">,</span> <span class="n">db</span>

<span class="c1"># 创建 app，并传入配置模式：development / production</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">create_app</span><span class="p">(</span><span class="s1">&#39;development&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>将 <code>__init__.py</code> 文件中创建 app 实例的方法移动到 <code>create_app</code> 方法中</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">config</span> <span class="kn">import</span> <span class="n">config</span>
  
<span class="c1"># 数据库</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">SQLAlchemy</span><span class="p">()</span>
<span class="n">redis_store</span> <span class="o">=</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">create_app</span><span class="p">(</span><span class="n">config_name</span><span class="p">):</span>
    <span class="s2">&#34;&#34;&#34;通过传入不同的配置名字，初始化其对应配置的应用实例&#34;&#34;&#34;</span>

    <span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
    
    <span class="c1"># 配置</span>
    <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="n">config_name</span><span class="p">])</span>
    <span class="c1"># 配置数据库</span>
    <span class="n">db</span><span class="o">.</span><span class="n">init_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
    <span class="c1"># 配置redis</span>
    <span class="k">global</span> <span class="n">redis_store</span>
    <span class="n">redis_store</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">StrictRedis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="n">config_name</span><span class="p">]</span><span class="o">.</span><span class="n">REDIS_HOST</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="n">config_name</span><span class="p">]</span><span class="o">.</span><span class="n">REDIS_PORT</span><span class="p">)</span>
    <span class="c1"># 开启csrf保护</span>
    <span class="n">CSRFProtect</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
    <span class="c1"># 设置session保存位置</span>
    <span class="n">Session</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">app</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="日志">日志</h2>
<h3 id="简介">简介</h3>
<p>日志是一种可以追踪某些软件运行时所发生事件的方法。软件开发人员可以向他们的代码中调用日志记录相关的方法来表明发生了某些事情。一个事件可以用一个可包含可选变量数据的消息来描述。此外，事件也有重要性的概念，这个重要性也可以被称为严重性级别（level）</p>
<h3 id="作用">作用</h3>
<p>通过log的分析，可以方便用户了解系统或软件、应用的运行情况；如果你的应用log足够丰富，也可以分析以往用户的操作行为、类型喜好、地域分布或其他更多信息；如果一个应用的log同时也分了多个级别，那么可以很轻易地分析得到该应用的健康状况，及时发现问题并快速定位、解决问题，补救损失。</p>
<p>简单来讲就是我们通过记录和分析日志可以了解一个系统或软件程序运行情况是否正常，也可以在应用程序出现故障时快速定位问题。不仅在开发中，在运维中日志也很重要</p>
<p>日志的作用可以简单总结为以下几点：程序调试、了解软件程序运行情况，是否正常、软件程序运行故障分析与问题定位、如果应用的日志信息足够详细和丰富，还可以用来做用户行为分析</p>
<h3 id="等级">等级</h3>
<p>我们先来思考下下面的两个问题：</p>
<ul>
<li>作为开发人员，在开发一个应用程序时需要什么日志信息？在应用程序正式上线后需要什么日志信息？</li>
<li>作为应用运维人员，在部署开发环境时需要什么日志信息？在部署生产环境时需要什么日志信息？</li>
</ul>
<p>在软件开发阶段或部署开发环境时，为了尽可能详细的查看应用程序的运行状态来保证上线后的稳定性，我们可能需要把该应用程序所有的运行日志全部记录下来进行分析，这是非常耗费机器性能的。当应用程序正式发布或在生产环境部署应用程序时，我们通常只需要记录应用程序的异常信息、错误信息等，这样既可以减小服务器的I/O压力，也可以更加方便的进行故障排查。那么，怎样才能在不改动应用程序代码的情况下实现在不同的环境记录不同详细程度的日志呢？这就是日志等级的作用了，我们通过配置文件指定我们需要的日志等级就可以了。不同的应用程序所定义的日志等级可能会有所差别，分的详细点的会包含以下几个等级：</p>
<ul>
<li>FATAL/CRITICAL = 重大的，危险的</li>
<li>ERROR = 错误</li>
<li>WARNING = 警告</li>
<li>INFO = 信息</li>
<li>DEBUG = 调试</li>
<li>NOTSET = 没有设置</li>
</ul>
<h3 id="字段信息与日志格式">字段信息与日志格式</h3>
<p>输出一条日志时，日志内容和日志级别是需要开发人员明确指定的。对于而其它字段信息，只需要是否显示在日志中就可以了。</p>
<h3 id="功能的实现">功能的实现</h3>
<p>Python 自身提供了一个用于记录日志的标准库模块：logging。</p>
<h4 id="logging-模块">logging 模块</h4>
<h5 id="简介-1">简介</h5>
<p>logging 模块定义的函数和类为应用程序和库的开发实现了一个灵活的事件日志系统。logging 模块是 Python 的一个标准库模块，由标准库模块提供日志记录 API 的关键好处是所有 Python 模块都可以使用这个日志记录功能。</p>
<h5 id="日志级别">日志级别</h5>
<p>logging模块默认定义了以下几个日志等级，它允许开发人员自定义其他日志级别，但是这是不被推荐的，尤其是在开发供别人使用的库时，因为这会导致日志级别的混乱。</p>
<ul>
<li>DEBUG 最详细的日志信息，典型应用场景是 问题诊断</li>
<li>INFO 信息详细程度仅次于DEBUG，通常只记录关键节点信息，用于确认一切都是按照我们预期的那样进行工作</li>
<li>WARNING 当某些不期望的事情发生时记录的信息（如，磁盘可用空间较低），但是此时应用程序还是正常运行的</li>
<li>ERROR 由于一个更严重的问题导致某些功能不能正常运行时记录的信息</li>
<li>FATAL/CRITICAL 整个系统即将/完全崩溃</li>
</ul>
<p>开发应用程序或部署开发环境时，可以使用 DEBUG 或 INFO 级别的日志获取尽可能详细的日志信息来进行开发或部署调试；应用上线或部署生产环境时，应该使用 WARNING 或 ERROR 或 CRITICAL 级别的日志来降低机器的I/O压力和提高获取错误日志信息的效率。</p>
<div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw"></i>提示<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">日志级别的指定通常都是在应用程序的配置文件中进行指定的。</div>
        </div>
    </div>
<h5 id="使用方式介绍">使用方式介绍</h5>
<ul>
<li>
<p>loggers 提供应用程序代码直接使用的接口</p>
</li>
<li>
<p>handlers 用于将日志记录发送到指定的目的位置</p>
</li>
<li>
<p>filters 提供更细粒度的日志过滤功能，用于决定哪些日志记录将会被输出（其它的日志记录将会被忽略）</p>
</li>
<li>
<p>formatters 用于控制日志信息的最终输出格式</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># 设置日志的记录等级</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span> <span class="c1"># 调试debug级</span>
<span class="c1"># 创建日志记录器，指明日志保存的路径、每个日志文件的最大大小、保存的日志文件个数上限</span>
<span class="n">file_log_handler</span> <span class="o">=</span> <span class="n">RotatingFileHandler</span><span class="p">(</span><span class="s2">&#34;logs/log&#34;</span><span class="p">,</span> <span class="n">maxBytes</span><span class="o">=</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">backupCount</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># 创建日志记录的格式 日志等级 输入日志信息的文件名 行数 日志信息</span>
<span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%(levelname)s</span><span class="s1"> </span><span class="si">%(filename)s</span><span class="s1">:</span><span class="si">%(lineno)d</span><span class="s1"> </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1"># 为刚创建的日志记录器设置日志记录格式</span>
<span class="n">file_log_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
<span class="c1"># 为全局的日志工具对象（flask app使用的）添加日志记录器</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_log_handler</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h5 id="函数记录">函数记录</h5>
<h6 id="最简单的日志输出">最简单的日志输出</h6>
<p>先来试着分别输出一条不同日志级别的日志记录：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&#34;This is a debug log.&#34;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;This is a info log.&#34;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&#34;This is a warning log.&#34;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&#34;This is a error log.&#34;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&#34;This is a critical log.&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>也可以这样写：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="s2">&#34;This is a debug log.&#34;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="s2">&#34;This is a info log.&#34;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span> <span class="s2">&#34;This is a warning log.&#34;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span> <span class="s2">&#34;This is a error log.&#34;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">,</span> <span class="s2">&#34;This is a critical log.&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h6 id="修改配置改变输出内容">修改配置改变输出内容</h6>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="details admonition warning open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-exclamation-triangle fa-fw"></i>切记<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">设置 <code>Configurations</code> 中的 <strong>Working directory</strong> 为当前项目</div>
        </div>
    </div>
<h3 id="集成日志到当前项目">集成日志到当前项目</h3>
<ul>
<li>
<p>在 <code>config.py</code> 文件中在不同的环境的配置下添加日志级别</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Config</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="o">...</span>

    <span class="c1"># 默认日志等级</span>
    <span class="n">LOG_LEVEL</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span>

<span class="k">class</span> <span class="nc">ProductionConfig</span><span class="p">(</span><span class="n">Config</span><span class="p">):</span>
    <span class="s2">&#34;&#34;&#34;生产模式下的配置&#34;&#34;&#34;</span>
    <span class="n">LOG_LEVEL</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在 <code>blog</code> 目录下的 <code>init.py</code> 文件中添加日志配置的相关方法</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">setup_log</span><span class="p">(</span><span class="n">config_name</span><span class="p">):</span>
    <span class="s2">&#34;&#34;&#34;配置日志&#34;&#34;&#34;</span>

    <span class="c1"># 设置日志的记录等级</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="n">config_name</span><span class="p">]</span><span class="o">.</span><span class="n">LOG_LEVEL</span><span class="p">)</span>  <span class="c1"># 调试debug级</span>
    <span class="c1"># 创建日志记录器，指明日志保存的路径、每个日志文件的最大大小、保存的日志文件个数上限</span>
    <span class="n">file_log_handler</span> <span class="o">=</span> <span class="n">RotatingFileHandler</span><span class="p">(</span><span class="s2">&#34;logs/log&#34;</span><span class="p">,</span> <span class="n">maxBytes</span><span class="o">=</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">backupCount</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># 创建日志记录的格式 日志等级 输入日志信息的文件名 行数 日志信息</span>
    <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%(levelname)s</span><span class="s1"> </span><span class="si">%(filename)s</span><span class="s1">:</span><span class="si">%(lineno)d</span><span class="s1"> </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1"># 为刚创建的日志记录器设置日志记录格式</span>
    <span class="n">file_log_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
    <span class="c1"># 为全局的日志工具对象（flask app使用的）添加日志记录器</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_log_handler</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在 <code>create_app</code> 方法中调用上一步创建的方法，并传入 <code>config_name</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">create_app</span><span class="p">(</span><span class="n">config_name</span><span class="p">):</span>
    <span class="o">...</span>

    <span class="c1"># 配置项目日志</span>
    <span class="n">setup_log</span><span class="p">(</span><span class="n">config_name</span><span class="p">)</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="o">...</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在项目根目录下创建日志目录文件夹 <code>logs</code></p>
<div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw"></i>提示<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">运行项目，当前项目日志已输出到 <code>logs</code> 的目录下自动创建的 log 文件中</div>
        </div>
    </div>
</li>
<li>
<p>在 logs 文件夹下创建 .gitkeep 文件，以便能将 logs 文件夹添加到远程仓库，并在 .gitignore 文件中添加忽略提交生成的日志文件</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">logs/log*
</code></pre></td></tr></table>
</div>
</div><p>在 Flask框架 中，其自己对 Python 的 logging 进行了封装，在 Flask 应用程序中，可以以如下方式进行输出 log:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">current_app.logger.debug<span class="o">(</span><span class="s1">&#39;debug&#39;</span><span class="o">)</span>
current_app.logger.error<span class="o">(</span><span class="s1">&#39;error&#39;</span><span class="o">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="蓝图">蓝图</h2>
<p>项目的蓝图模块可以按以下方式来分：</p>
<ul>
<li>按功能模块来分，比如：文章模块、关于模块</li>
<li>按接口版本来分，某个版本的接口放一个文件夹下面</li>
</ul>
<p>因为本项目是前后端不分离的项目，界面数据大部分都使用模板的形式进行渲染，很少涉及到通过接口的形式返回数据，所以本项目使用按功能模块来划分蓝图。</p>
<ul>
<li>
<p>在 <code>blog</code> 目录下创建 <code>modules</code> Package，modules 存放当前项目所有的模块</p>
</li>
<li>
<p>在 <code>modules</code> 文件夹下创建 <code>index</code> 文件夹， 并在此文件夹下创建 <code>views.py</code> 文件，将 <code>manage.py</code> 中定义的路由拷贝至该文件中</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/index&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">&#39;index&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>暂时忽略报错，此处的index文件夹就是一个模块</p>
</li>
<li>
<p>到这一步 <code>manage.py</code> 中内容基本上都抽取完成，剩余内容如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask_script</span> <span class="kn">import</span> <span class="n">Manager</span>
<span class="kn">from</span> <span class="nn">flask_migrate</span> <span class="kn">import</span> <span class="n">Migrate</span><span class="p">,</span> <span class="n">MigrateCommand</span>
<span class="kn">from</span> <span class="nn">info</span> <span class="kn">import</span> <span class="n">create_app</span><span class="p">,</span> <span class="n">db</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">create_app</span><span class="p">(</span><span class="s1">&#39;development&#39;</span><span class="p">)</span>

<span class="c1"># 添加扩展命令行</span>
<span class="n">manager</span> <span class="o">=</span> <span class="n">Manager</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>

<span class="c1"># 数据库迁移</span>
<span class="n">Migrate</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>
<span class="n">manager</span><span class="o">.</span><span class="n">add_command</span><span class="p">(</span><span class="s1">&#39;db&#39;</span><span class="p">,</span> <span class="n">MigrateCommand</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">manager</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在 <code>index</code> 文件夹中的 <code>__init__.py</code>创建其自已的蓝图</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Blueprint</span>
  
<span class="n">index_blu</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s2">&#34;index&#34;</span><span class="p">,</span> <span class="vm">__name__</span><span class="p">)</span>
  
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在 <code>views.py</code> 中导入蓝图，并使用该蓝图注册路由</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">index_blu</span>

<span class="nd">@index_blu.route</span><span class="p">(</span><span class="s1">&#39;/index&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">&#39;index&#39;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>将上一步创建出来的蓝图注册到 app 中</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">create_app</span><span class="p">(</span><span class="n">config_name</span><span class="p">):</span>
    <span class="o">...</span>
  
    <span class="c1"># 注册蓝图</span>
    <span class="kn">from</span> <span class="nn">info.modules.index</span> <span class="kn">import</span> <span class="n">index_blu</span>
    <span class="n">app</span><span class="o">.</span><span class="n">register_blueprint</span><span class="p">(</span><span class="n">index_blu</span><span class="p">)</span>
  
    <span class="k">return</span> <span class="n">app</span>
</code></pre></td></tr></table>
</div>
</div><p>运行测试</p>
</li>
</ul>
<h2 id="数据库表">数据库表</h2>
<h3 id="分析">分析</h3>
<p>根据需求分析需要4个表格：</p>
<ul>
<li>
<p>文章(Post)：</p>
<table>
<thead>
<tr>
<th align="center">字段</th>
<th align="center">类型</th>
<th align="center">条件</th>
<th align="center">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">title</td>
<td align="center">CharField</td>
<td align="center">max_length=100</td>
<td align="center">标题</td>
</tr>
<tr>
<td align="center">body</td>
<td align="center">TextField</td>
<td align="center">-</td>
<td align="center">正文</td>
</tr>
<tr>
<td align="center">created_time</td>
<td align="center">DateTimeField</td>
<td align="center">-</td>
<td align="center">创建时间</td>
</tr>
<tr>
<td align="center">last_modified_time</td>
<td align="center">DateTimeField</td>
<td align="center">-</td>
<td align="center">最后修改时间</td>
</tr>
<tr>
<td align="center">abstract</td>
<td align="center">CharField</td>
<td align="center">max_length=200, blank=True</td>
<td align="center">摘要</td>
</tr>
<tr>
<td align="center">category</td>
<td align="center">ForeignKey</td>
<td align="center">Category, on_delete=models.CASCADE</td>
<td align="center">分类</td>
</tr>
<tr>
<td align="center">tags</td>
<td align="center">ManyToManyField</td>
<td align="center">Tag, blank=True</td>
<td align="center">标签</td>
</tr>
<tr>
<td align="center">author</td>
<td align="center">ForeignKey</td>
<td align="center">User, on_delete=models.CASCADE</td>
<td align="center">作者</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>分类(Category)：</p>
<table>
<thead>
<tr>
<th align="center">字段</th>
<th align="center">类型</th>
<th align="center">条件</th>
<th align="center">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">name</td>
<td align="center">CharField</td>
<td align="center">max_length=100</td>
<td align="center">分类名</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>标签(Tag)：</p>
<table>
<thead>
<tr>
<th align="center">字段</th>
<th align="center">类型</th>
<th align="center">条件</th>
<th align="center">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">name</td>
<td align="center">CharField</td>
<td align="center">max_length=100</td>
<td align="center">标签名</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>用户(Info)：</p>
<table>
<thead>
<tr>
<th align="center">字段</th>
<th align="center">类型</th>
<th align="center">条件</th>
<th align="center">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">name</td>
<td align="center">CharField</td>
<td align="center">max_length=50</td>
<td align="center">作者名</td>
</tr>
<tr>
<td align="center">homepage</td>
<td align="center">CharField</td>
<td align="center">max_length=100</td>
<td align="center">主页</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h3 id="数据库表迁移">数据库表迁移</h3>
<ul>
<li>
<p>确认当前配置的数据库是否存在</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">mysql&gt; use flaskblog<span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>将 <code>constants.py</code> 和 <code>models.py</code> 文件拷贝到项目的 <code>blog</code> 目录下</p>
<div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw"></i>提示<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">constants.py 是当前项目中要使用的一些常量，预先定义好的，models.py 文件中需要使用到该文件中的一些常量</div>
        </div>
    </div>
</li>
<li>
<p>并在 <code>manage.py</code> 中导入 <code>models</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">form</span> <span class="n">info</span> <span class="kn">import</span> <span class="nn">models</span>
</code></pre></td></tr></table>
</div>
</div><div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw"></i>提示<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">在迁移的时候以便能读取到对应模型</div>
        </div>
    </div>
</li>
<li>
<p>执行数据库迁移</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">flaskblog % python manage.py db init
flaskblog % python manage.py db migrate -m<span class="s2">&#34;initial&#34;</span>
flaskblog % python manage.py db upgrade
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>查看数据库表是否创建完成</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">mysql&gt; show tables<span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>执行导入初始分类的 SQL 语句</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">mysql&gt; <span class="nb">source</span> info_info_category.sql
</code></pre></td></tr></table>
</div>
</div><div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw"></i>提示<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">生成的迁移文件不需要提交到 git 保存，所以需要在 .gitignore 文件中添加以下内容以便忽略迁移所生成的系列文件</div>
        </div>
    </div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">migrations
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="测试数据的添加">测试数据的添加</h3>
<ul>
<li>先添加分类测试数据</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">mysql&gt; <span class="nb">source</span> 路径/flaskblog_category.sql
</code></pre></td></tr></table>
</div>
</div><ul>
<li>再添加新闻测试数据</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">mysql&gt; <span class="nb">source</span> 路径/flaskblog_blog.sql
</code></pre></td></tr></table>
</div>
</div><h2 id="静态文件导入">静态文件导入</h2>
<ul>
<li>
<p>在项目 <code>blog</code> 目录下创建 <code>static</code> 文件夹</p>
</li>
<li>
<p>将前端人员开发好的 <code>blog</code> 和 <code>admin</code> 两个静态文件夹拖入到项目</p>
<ul>
<li><code>news</code>文件夹内代表新闻前台页面</li>
<li><code>admin</code>文件夹内代表新闻的后台页面</li>
</ul>
</li>
<li>
<p>运行项目，使用浏览器访问：http://127.0.0.1:5000/static/blog/index.html 查看效果</p>
</li>
</ul>
<h2 id="注册根路由">注册根路由</h2>
<h3 id="创建模板目录">创建模板目录</h3>
<p>在 <strong>static</strong> 同级目录创建 <strong>templates</strong> 文件夹，并在此目录下创建 <strong>post</strong> 文件夹用于存放新闻前台模板文件。(此步可以省略，只是在 Pycharm 中标识该目录为模板目录)设置 <strong>templates</strong> 目录成模板目录属性，操作方式：右键点击 <strong>templates</strong> 目录，选择 <code>Mark Directory as</code> -&gt; <code>Template Folder</code>如果没有设置模板语言，会弹出是否设置模板语言，点击 <strong>Yes</strong>，跳转到模板语言设置界面，设置模板语言为 Jinja2</p>
<h3 id="添加模板并创建根路由视图函数">添加模板并创建根路由视图函数</h3>
<p>使用 Pycharm 将 <code>static/news/index.html</code> 文件移动到 <code>templates/news/</code> 目录下，并在 <code>index.py</code> 中添加根路由访问视图</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">index_blu</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">render_template</span>


<span class="nd">@index_blu.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;news/index.html&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>运行，访问根路由测试</p>
<h2 id="网站图标展示">网站图标展示</h2>
<ul>
<li>自定义视图函数，访问网站图标，send_static_file 是系统访问静态文件所调用的方法</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="nd">@index_blu.route</span><span class="p">(</span><span class="s1">&#39;/favicon.ico&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">favicon</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">current_app</span><span class="o">.</span><span class="n">send_static_file</span><span class="p">(</span><span class="s1">&#39;news/favicon.ico&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2020-06-14</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-flask%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/index.md" target="_blank">阅读原始文档</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://silencehuliang.github.io/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-flask%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/" data-title="Python学习之路-Flask项目:开发准备" data-hashtags="Python学习之路"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://silencehuliang.github.io/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-flask%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/" data-hashtag="Python学习之路"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="分享到 WhatsApp" data-sharer="whatsapp" data-url="https://silencehuliang.github.io/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-flask%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/" data-title="Python学习之路-Flask项目:开发准备" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://silencehuliang.github.io/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-flask%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/" data-title="Python学习之路-Flask项目:开发准备"><i data-svg-src="/lib/simple-icons/icons/line.min.svg"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://silencehuliang.github.io/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-flask%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/" data-title="Python学习之路-Flask项目:开发准备"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Myspace" data-sharer="myspace" data-url="https://silencehuliang.github.io/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-flask%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/" data-title="Python学习之路-Flask项目:开发准备" data-description=""><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg"></i></a><a href="javascript:void(0);" title="分享到 Blogger" data-sharer="blogger" data-url="https://silencehuliang.github.io/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-flask%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/" data-title="Python学习之路-Flask项目:开发准备" data-description=""><i class="fab fa-blogger fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Evernote" data-sharer="evernote" data-url="https://silencehuliang.github.io/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-flask%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/" data-title="Python学习之路-Flask项目:开发准备"><i class="fab fa-evernote fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/">Python学习之路</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/python%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF-%E6%B7%B1%E6%8B%B7%E8%B4%9D%E4%B8%8E%E6%B5%85%E6%8B%B7%E8%B4%9D/" class="prev" rel="prev" title="Python学习之路-深拷贝与浅拷贝"><i class="fas fa-angle-left fa-fw"></i>Python学习之路-深拷贝与浅拷贝</a></div>
</div>
<div id="comments"><div id="valine" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/">Valine</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.74.3">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2018 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Silence</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/valine/valine.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.4afae7d446ba01ebf7fff19893eaf3a1.css" integrity="md5-Svrn1Ea6Aev3//GYk&#43;rzoQ=="><link rel="stylesheet" href="/lib/katex/copy-tex.min.b1994d1b9785dd8801dbf655df7bf6d9.css" integrity="md5-sZlNG5eF3YgB2/ZV33v22Q=="><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.acf82ee47549fdc386d02768992a49ad.css" integrity="md5-rPgu5HVJ/cOG0CdomSpJrQ=="><script type="text/javascript" src="/lib/valine/Valine.min.b1d2c9b89c70dbf0a8541bfd36afafa1.js" integrity="md5-sdLJuJxw2/CoVBv9Nq&#43;voQ=="></script><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.100efdceabf7a138f3297e437d078f74.js" integrity="md5-EA79zqv3oTjzKX5DfQePdA=="></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.ae7c5011def46b283696baf367586b5d.js" integrity="md5-rnxQEd70ayg2lrrzZ1hrXQ=="></script><script type="text/javascript" src="/lib/lunr/lunr.min.a08f2562fde4550269dfc13028ed2502.js" integrity="md5-oI8lYv3kVQJp38EwKO0lAg=="></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.b82fb8d93ce0ea6a485dfa3a0b1e7573.js" integrity="md5-uC&#43;42Tzg6mpIXfo6Cx51cw=="></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.f1ba3e22560e2eb7474f28feb4507617.js" integrity="md5-8bo&#43;IlYOLrdHTyj&#43;tFB2Fw=="></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.b80e49640d4794d4333d00db76ea22f7.js" integrity="md5-uA5JZA1HlNQzPQDbduoi9w=="></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.af8ab36589315582ccdd82f22e84bffb.js" integrity="md5-r4qzZYkxVYLM3YLyLoS/&#43;w=="></script><script type="text/javascript" src="/lib/sharer/sharer.min.c3c3372b4cf5c56dd4e5a4be8ada86c9.js" integrity="md5-w8M3K0z1xW3U5aS&#43;itqGyQ=="></script><script type="text/javascript" src="/lib/typeit/typeit.min.b5f3481ebeaa3e56a2f5f96ea648bf69.js" integrity="md5-tfNIHr6qPlai9flupki/aQ=="></script><script type="text/javascript" src="/lib/katex/katex.min.c158c9e823b681cf535f46596b5e4eac.js" integrity="md5-wVjJ6CO2gc9TX0ZZa15OrA=="></script><script type="text/javascript" src="/lib/katex/auto-render.min.28cd0b98cd3f4fa37d52f3ffe47ad9d4.js" integrity="md5-KM0LmM0/T6N9UvP/5HrZ1A=="></script><script type="text/javascript" src="/lib/katex/copy-tex.min.bfaec7d1dea915d74a7a6d833f0ff62e.js" integrity="md5-v67H0d6pFddKem2DPw/2Lg=="></script><script type="text/javascript" src="/lib/katex/mhchem.min.1bbb252363e83547d4b2186a41eaca28.js" integrity="md5-G7slI2PoNUfUshhqQerKKA=="></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.4a48532bf0b17c058b8b6854f49de23f.js" integrity="md5-SkhTK/CxfAWLi2hU9J3iPw=="></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{"valine":{"appId":"c4VA4R1Xg3drBKSQzNfWnWlF-gzGzoHsz","appKey":"upEyt7esgWCbm0L7EPDH6bhV","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"zh-cn","meta":["nick","mail"],"pageSize":10,"placeholder":"说点什么吧...","recordIP":true,"visitor":true}},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"data":{"id-1":"Silence’s Blog","id-2":"Silence’s Blog"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"lunr"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.7bc7989e979c4a19d97db3ab311a80fe.js" integrity="md5-e8eYnpecShnZfbOrMRqA/g=="></script></body>
</html>
