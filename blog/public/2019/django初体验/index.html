<!DOCTYPE html>
<html lang="zh-cn">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="SilenceHL">
  
  
  
  <link rel="prev" href="http://49.235.231.121/2019/%E8%AE%B0django2.x%E9%85%8D%E7%BD%AEmysql/" />
  <link rel="next" href="http://49.235.231.121/2019/django2.0%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/" />
  <link rel="canonical" href="http://49.235.231.121/2019/django%E5%88%9D%E4%BD%93%E9%AA%8C/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           Django初体验 | SilenceHL Blog
       
  </title>
  <meta name="title" content="Django初体验 | SilenceHL Blog">
    
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "http:\/\/49.235.231.121\/"
    },
    "articleSection" : "posts",
    "name" : "Django初体验",
    "headline" : "Django初体验",
    "description" : "Django初体验",
    "inLanguage" : "zh-cn",
    "author" : "SilenceHL",
    "creator" : "SilenceHL",
    "publisher": "SilenceHL",
    "accountablePerson" : "SilenceHL",
    "copyrightHolder" : "SilenceHL",
    "copyrightYear" : "2019",
    "datePublished": "2019-01-26 00:00:00 \x2b0000 UTC",
    "dateModified" : "2019-01-26 00:00:00 \x2b0000 UTC",
    "url" : "http:\/\/49.235.231.121\/2019\/django%E5%88%9D%E4%BD%93%E9%AA%8C\/",
    "wordCount" : "4562",
    "keywords" : [ "Django2.x", "SilenceHL Blog"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    
        <div class="top-scroll-bar"></div>
    
    <div class="container">
        <div class="navbar-header header-logo">
            
            <span class="logo_mark" >></span>
            <a href="http://49.235.231.121/">
                <span class="logo_text" >$ cd /home/ </span>
                <span class="logo_cursor" ></span>
            </a>
            
        </div>
        <div class="navbar-right">
                
                <span class="menu">
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
                </span>
                <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-dark-mode"></i></a>
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     
         <div class="top-scroll-bar"></div>
     
     <div class="container">
        <div class="navbar-header">
            <div class="header-logo">
                
                    <span class="logo_mark">></span>
                    <a href="http://49.235.231.121/">
                        <span class="logo_text">$ cd /home/ </span>
                        <span class="logo_cursor"></span>
                </a>
                
            </div>
            <div class="navbar-right">
                <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-dark-mode"></i></a>
                <div class="menu-toggle">
                    <span></span><span></span><span></span>
                </div>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">Django初体验</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="http://49.235.231.121/" rel="author">SilenceHL</a> with ♥ 
                <span class="post-time">
                on <time datetime=2019-01-26 itemprop="datePublished">January 26, 2019</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="http://49.235.231.121/categories/django/"> Django </a>
                        
                </span>
                <span class="post-word-count">, 4562 words</span>
        </div>
    </header>
    <div class="post-content">
        

        
            
        

        
        
     
          
          
          

          
          
          

          <p><strong>声明：以下内容均为我个人的理解，如果发现错误或者疑问可以联系我共同探讨</strong></p>
<h2 id="简介">简介</h2>
<p>在Django2.0以后，Django已经不支持python2.7，所以我们需要一个由python3的系统环境，这里一python3.6为例</p>
<h2 id="安装django">安装Django</h2>
<h3 id="三种方式安装">三种方式安装</h3>
<h4 id="pip安装">pip安装</h4>
<ul>
<li>
<p>一般情况下安装python后会帮你安装好pip，当你没安装时使用这个<a href="https://pip.pypa.io/en/latest/installing/#installing-with-get-pip-py">链接</a>安装,记得更新到最新版本</p>
</li>
<li>
<p>安装并使用virtualenv</p>
</li>
<li>
<p>在创建好并激活的虚拟环境中输入一下命令</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> pip install Django
</code></pre></div></li>
</ul>
<h4 id="通过第三方软件包">通过第三方软件包</h4>
<p>管理系统集成的Django</p>
<h4 id="安装开发版本">安装开发版本</h4>
<ul>
<li>
<p>安装好<a href="https://git-scm.com/">git</a></p>
</li>
<li>
<p>输入一下命令下载Django</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ git clone https://github.com/django/django.git
</code></pre></div></li>
<li>
<p>安装并使用virtualenv</p>
</li>
<li>
<p>在创建好并激活的虚拟环境中输入一下命令</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> pip install <span style="color:#f92672">-</span>e django<span style="color:#f92672">/</span>
</code></pre></div></li>
</ul>
<p>安装好Django后可以通过一下命令查看当前Django版本</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> python <span style="color:#f92672">-</span>m django <span style="color:#f92672">-</span><span style="color:#f92672">-</span>version
</code></pre></div><h2 id="django初体验">Django初体验</h2>
<h3 id="安装并使用virtualenv">安装并使用virtualenv</h3>
<p>详细过程见<a href="http://49.235.231.121/2019/python%E6%90%AD%E5%BB%BA%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/">这个链接</a></p>
<h3 id="创建django项目">创建Django项目</h3>
<p>在项目存放目录打开命令行运行一下命令：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> django<span style="color:#f92672">-</span>admin startproject mysite
</code></pre></div><p>这句话执行过后会在当前目录生成一个名字为mysite的Django项目，目录结构为下</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mysite/
    manage.py
    mysite/
        __init__.py
        settings.py
        urls.py
        wsgi.py
</code></pre></div><p>这些目录和文件的作用：</p>
<ul>
<li>
<p>mysite/目录：存放项目的容器，他的名字不重要可以更换为你喜欢的任何名字</p>
</li>
<li>
<p>manage.py：Django项目的启动文件，他可以让你通过各种方式管理Django项目。</p>
</li>
<li>
<p>mysite/mysite/目录：项目目录，里面存放项目相关的文件</p>
</li>
<li>
<p>mysite/mysite/settings.py：Django项目的配置文件</p>
</li>
<li>
<p>mysite/mysite/urls.py：Django项目的url声明文件,他将url对应相关的app的视图</p>
</li>
<li>
<p>mysite/mysite/wsgi.py：Django项目wsgi服务器的入口</p>
</li>
<li>
<p>当输入以下命令，并进入浏览器输入：http://127.0.0.1:8000/看到Django启动成功</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> python manage<span style="color:#f92672">.</span>py runserver
</code></pre></div><p>这里能启动成功是因为Django自带一个简易的服务器（用纯 Python 写的轻量级的 Web 服务器）。他能帮助我们快速开发。</p>
</li>
</ul>
<h3 id="创建一个应用">创建一个应用</h3>
<ul>
<li>
<p>将当前目录切换到manage.py所在的目录，输入下面的命令创建一个应用:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> python manage<span style="color:#f92672">.</span>py startapp demo
</code></pre></div><p>该应用的目录结构大致如下</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">demo/
    __init__.py
    admin.py
    apps.py
    migrations/
        __init__.py
    models.py
    tests.py
    views.py
</code></pre></div><p>这些目录和文件的作用：</p>
<ul>
<li>admin.py：管理admin后台相关数据库模型</li>
<li>apps.py：该应用的相关配置</li>
<li>migrations/文件夹及其内容：数据库迁移相关的文件夹，里面存放着迁移版本，迁移信息等</li>
<li>models.py：编写模型类的文件</li>
<li>tests.py：用于测试的文件</li>
<li>view.py：编写视图的文件</li>
</ul>
<p>我们还要在项目配置文件中注册该app，打开settings.py文件，找到INSTALLED_APPS，在列表的最后添加demoapp</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">mysite<span style="color:#f92672">/</span>settings<span style="color:#f92672">.</span>py
INSTALLED_APPS <span style="color:#f92672">=</span> [
    <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">django.contrib.admin</span><span style="color:#e6db74">&#39;</span>,
    <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">django.contrib.auth</span><span style="color:#e6db74">&#39;</span>,
    <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">django.contrib.contenttypes</span><span style="color:#e6db74">&#39;</span>,
    <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">django.contrib.sessions</span><span style="color:#e6db74">&#39;</span>,
    <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">django.contrib.messages</span><span style="color:#e6db74">&#39;</span>,
    <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">django.contrib.staticfiles</span><span style="color:#e6db74">&#39;</span>,
    <span style="color:#75715e"># 注册demo</span>
    <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">demo.apps.DemoConfig</span><span style="color:#e6db74">&#39;</span>
]
    
</code></pre></div></li>
</ul>
<h3 id="编写第一个视图">编写第一个视图</h3>
<p>视图在应用的views.py中编写</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">demo<span style="color:#f92672">/</span>views<span style="color:#f92672">.</span>py

<span style="color:#f92672">from</span> django.http <span style="color:#f92672">import</span> HttpResponse

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">index</span>(request):
  <span style="color:#66d9ef">return</span> HttpResponse(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Hello, world!</span><span style="color:#e6db74">&#34;</span>)
</code></pre></div><p>为了能看到效果我们还需要配置一下url，在demo目录下创建一个urls.py，并输入一下代码</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">/</span>demo<span style="color:#f92672">/</span>urls<span style="color:#f92672">.</span>py

<span style="color:#f92672">from</span> django.urls <span style="color:#f92672">import</span> path
<span style="color:#f92672">from</span> . <span style="color:#f92672">import</span> views

urlpatterns <span style="color:#f92672">=</span> [
  path(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">&#34;</span>,views<span style="color:#f92672">.</span>index,name<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">index</span><span style="color:#e6db74">&#39;</span>),
]
</code></pre></div><p>更改项目url，通过修改项目urls.py文件修改路由</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">/</span>mysite<span style="color:#f92672">/</span>urls<span style="color:#f92672">.</span>py

<span style="color:#f92672">from</span> django.contrib <span style="color:#f92672">import</span> admin
<span style="color:#f92672">from</span> django.urls <span style="color:#f92672">import</span> include, path

urlpatterns <span style="color:#f92672">=</span> [
    path(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">demo/</span><span style="color:#e6db74">&#39;</span>, include(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">demo.urls</span><span style="color:#e6db74">&#39;</span>)),
    path(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">admin/</span><span style="color:#e6db74">&#39;</span>, admin<span style="color:#f92672">.</span>site<span style="color:#f92672">.</span>urls),
]
</code></pre></div><p>这里include是将demo/的路由转发到demo应用的urls.py里。每当 Django 遇到 include时，它会截断与此项匹配的 URL 的部分，并将剩余的字符串发送到 对应urls.py以供进一步处理。</p>
<p>path有五个参数：route、view、kwargs、name、Pattern，其中route、view是必须传入的参数</p>
<ul>
<li>route：匹配url的准则（类似于正则表达式）。当Django响应一个请求时，他会从urlpatterns的第一项开始，按顺序依次匹配，知道找到匹配的项</li>
<li>view：目标视图函数。当route找到匹配的项后，会调用当前的视图函数，并传入一个HttpRequest对象作为第一个参数，route中的参数一关键字参数的形式传入</li>
<li>kwargs：关键字参数。任意个关键字参数可以作为一个字典传递给目标视图函数。</li>
<li>name：为url取的名字。他可以使Django在任意地方引用他</li>
<li>Pattern：匹配模式</li>
</ul>
<p>现在可以启动Django程序来看是否正常工作</p>
<h3 id="数据库">数据库</h3>
<h4 id="创建数据库">创建数据库</h4>
<p>进入mysql并创建一个test数据库，字符设置为utf8</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#960050;background-color:#1e0010">$</span> mysql <span style="color:#f92672">-</span>uroot <span style="color:#f92672">-</span>p
mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">create</span> <span style="color:#66d9ef">database</span> test <span style="color:#66d9ef">charset</span><span style="color:#f92672">=</span>utf8;
Query OK, <span style="color:#ae81ff">1</span> row <span style="color:#a6e22e">affected</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><h4 id="数据库配置">数据库配置</h4>
<p>首先我们需要配置mysite/setting.py中的数据库DATABASES选项，Django默认是sqlite数据库，如果个人项目不大的情况下可以使用这个，也可以使用自己熟悉的数据库，Django不仅支持sqlite，postgresql，mysql，或oracle，还支持很多有第三方插件的数据库，我使用mysql数据库</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">/</span>mysite<span style="color:#f92672">/</span>settings<span style="color:#f92672">.</span>py
DATABASES <span style="color:#f92672">=</span> {
    <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">default</span><span style="color:#e6db74">&#39;</span>: {
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ENGINE</span><span style="color:#e6db74">&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">django.db.backends.mysql</span><span style="color:#e6db74">&#39;</span>,
        <span style="color:#75715e"># 数据库名</span>
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">NAME</span><span style="color:#e6db74">&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">test</span><span style="color:#e6db74">&#39;</span>, 
        <span style="color:#75715e"># 用户名</span>
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">USER</span><span style="color:#e6db74">&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">root</span><span style="color:#e6db74">&#39;</span>, 
        <span style="color:#75715e"># 密码</span>
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">PASSWORD</span><span style="color:#e6db74">&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">mysql</span><span style="color:#e6db74">&#39;</span>
        <span style="color:#75715e"># 主机,默认为localhost</span>
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">HOST</span><span style="color:#e6db74">&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>
        <span style="color:#75715e"># 端口号，默认为3306</span>
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">PORT</span><span style="color:#e6db74">&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>
    }
}
</code></pre></div><h4 id="数据库迁移">数据库迁移</h4>
<p>因为Django自带应用已经为我们编写了一些数据模型，即时我们不编写任何模型也可以直接使用数据库迁移命令进行迁移</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> python manage<span style="color:#f92672">.</span>py migrate
</code></pre></div><p>会看到初始化了很多用户、权限相关的表</p>
<p>创建一个管理员账号，依次输入用户名、邮箱、密码、确认密码，建议密码设置复杂点</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> python manage<span style="color:#f92672">.</span>py createsuperuser
<span style="color:#960050;background-color:#1e0010">用</span><span style="color:#960050;background-color:#1e0010">户</span><span style="color:#960050;background-color:#1e0010">名</span> (leave blank to use <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">02</span><span style="color:#e6db74">&#39;</span>): admin
<span style="color:#960050;background-color:#1e0010">电</span><span style="color:#960050;background-color:#1e0010">子</span><span style="color:#960050;background-color:#1e0010">邮</span><span style="color:#960050;background-color:#1e0010">件</span><span style="color:#960050;background-color:#1e0010">地</span><span style="color:#960050;background-color:#1e0010">址</span>: <span style="color:#ae81ff">1</span><span style="color:#a6e22e">@gmail.com</span>
Password:
Password (again):
<span style="color:#960050;background-color:#1e0010">密</span><span style="color:#960050;background-color:#1e0010">码</span><span style="color:#960050;background-color:#1e0010">跟</span> <span style="color:#960050;background-color:#1e0010">用</span><span style="color:#960050;background-color:#1e0010">户</span><span style="color:#960050;background-color:#1e0010">名</span> <span style="color:#960050;background-color:#1e0010">太</span><span style="color:#960050;background-color:#1e0010">相</span><span style="color:#960050;background-color:#1e0010">似</span><span style="color:#960050;background-color:#1e0010">了</span><span style="color:#960050;background-color:#1e0010">。</span>
<span style="color:#960050;background-color:#1e0010">密</span><span style="color:#960050;background-color:#1e0010">码</span><span style="color:#960050;background-color:#1e0010">长</span><span style="color:#960050;background-color:#1e0010">度</span><span style="color:#960050;background-color:#1e0010">太</span><span style="color:#960050;background-color:#1e0010">短</span><span style="color:#960050;background-color:#1e0010">。</span><span style="color:#960050;background-color:#1e0010">密</span><span style="color:#960050;background-color:#1e0010">码</span><span style="color:#960050;background-color:#1e0010">必</span><span style="color:#960050;background-color:#1e0010">须</span><span style="color:#960050;background-color:#1e0010">包</span><span style="color:#960050;background-color:#1e0010">含</span><span style="color:#960050;background-color:#1e0010">至</span><span style="color:#960050;background-color:#1e0010">少</span> <span style="color:#ae81ff">8</span> <span style="color:#960050;background-color:#1e0010">个</span><span style="color:#960050;background-color:#1e0010">字</span><span style="color:#960050;background-color:#1e0010">符</span><span style="color:#960050;background-color:#1e0010">。</span>
<span style="color:#960050;background-color:#1e0010">这</span><span style="color:#960050;background-color:#1e0010">个</span><span style="color:#960050;background-color:#1e0010">密</span><span style="color:#960050;background-color:#1e0010">码</span><span style="color:#960050;background-color:#1e0010">太</span><span style="color:#960050;background-color:#1e0010">常</span><span style="color:#960050;background-color:#1e0010">见</span><span style="color:#960050;background-color:#1e0010">了</span><span style="color:#960050;background-color:#1e0010">。</span>
Bypass password validation <span style="color:#f92672">and</span> create user anyway<span style="color:#960050;background-color:#1e0010">?</span> [y<span style="color:#f92672">/</span>N]: y
Superuser created successfully<span style="color:#f92672">.</span>

</code></pre></div><p>接下来启动项目，并在浏览器中输入http://127.0.0.1:8000/admin，进入后台管理界面</p>
<p><img src="https://tvax2.sinaimg.cn/large/006lmzsGgy1gav1o59elyj31h90s7dgw.jpg" alt=""></p>
<p>输入账号密码，点击登录即可</p>
<p><img src="https://tvax4.sinaimg.cn/large/006lmzsGgy1gav1on3qmaj31h70s9js7.jpg" alt=""></p>
<p>数据库迁移，需要三步</p>
<ul>
<li>
<p>编写models.py文件，改变模型。</p>
</li>
<li>
<p>运行 python manage.py makemigrations为模型的改变生成迁移文件。</p>
</li>
<li>
<p>运行 python manage.py migrate 来应用数据库迁移。</p>
</li>
</ul>
<h4 id="创建一个图书模型">创建一个图书模型</h4>
<p>在demo应用下创建一个图书模型</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">/</span>demo<span style="color:#f92672">/</span>models<span style="color:#f92672">.</span>py

<span style="color:#f92672">from</span> django.db <span style="color:#f92672">import</span> models

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Books</span>(models<span style="color:#f92672">.</span>Model):
    <span style="color:#75715e"># 书名</span>
    book_name <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>CharField(max_length<span style="color:#f92672">=</span><span style="color:#ae81ff">200</span>)
    <span style="color:#75715e"># 作者</span>
    author <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>CharField(max_length<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>)
</code></pre></div><p>建立的模型有两个字段，书名和作者，使用了字符类型，增加了长度限制（<strong>注意在使用CharField时必须要添加max_length限制</strong>）</p>
<p>创建迁移模型并生成迁移文件</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> python manage<span style="color:#f92672">.</span>py makemigrations demo
Migrations <span style="color:#66d9ef">for</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">demo</span><span style="color:#e6db74">&#39;</span>:
  demo\migrations\<span style="color:#ae81ff">0001</span>_initial<span style="color:#f92672">.</span>py
    <span style="color:#f92672">-</span> Create model Books
</code></pre></div><p>会出现创建了Books这个模型，在demo应用的migrations文件夹下会多一个0001_initila.py的迁移文件，可以使用python manage.py sqlmigrate demo 0001可以查看这次数据库迁移的操作与具体的SQL语句</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> python manage<span style="color:#f92672">.</span>py sqlmigrate demo <span style="color:#ae81ff">0001</span>
BEGIN;
<span style="color:#f92672">-</span><span style="color:#f92672">-</span>
<span style="color:#f92672">-</span><span style="color:#f92672">-</span> Create model Books
<span style="color:#f92672">-</span><span style="color:#f92672">-</span>
CREATE TABLE <span style="color:#e6db74">`demo_books`</span> (<span style="color:#e6db74">`id`</span> integer AUTO_INCREMENT NOT NULL PRIMARY KEY, <span style="color:#e6db74">`book_name`</span> varchar(<span style="color:#ae81ff">200</span>) NOT NULL, <span style="color:#e6db74">`auhtor`</span> varchar(<span style="color:#ae81ff">50</span>) NOT NULL);
COMMIT;
</code></pre></div><p>需要注意一下几点：</p>
<ul>
<li>输出的内容与使用的数据库有关。</li>
<li>数据库的表名默认是“应用名_模型名的小写”，也可以自定义表名。</li>
<li>主键会默认自动创建，也可以自定义主键。</li>
<li>Django会为使用的数据库定制相关SQL语句，例如主键：integer AUTO_INCREMENT NOT NULL PRIMARY KEY，varchar：NOT NULL</li>
<li>sqlmigrate命令并没有真正执行迁移命令，他只是将迁移命令执行的流程输出到屏幕上，供你查看</li>
</ul>
<p>执行check命令对项目做检查</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> python manage<span style="color:#f92672">.</span>py check
System check identified no issues (<span style="color:#ae81ff">0</span> silenced)<span style="color:#f92672">.</span>
</code></pre></div><p>没有问题后执行迁移命令</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> python manage<span style="color:#f92672">.</span>py migrate
Operations to perform:
  Apply all migrations: admin, auth, contenttypes, demo, sessions
Running migrations:
  Applying demo<span style="color:#f92672">.</span><span style="color:#ae81ff">0001</span>_initial<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span> OK
</code></pre></div><p>看到以上内容即完成了数据库迁移</p>
<p>通过Python命令行尝试</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> python manage<span style="color:#f92672">.</span>py shell
<span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">from</span> demo.models <span style="color:#f92672">import</span> Books
<span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;</span> ggzh <span style="color:#f92672">=</span> Books(book_name<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">硅谷之火</span><span style="color:#e6db74">&#34;</span>,author<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">迈克尔.斯韦因</span><span style="color:#e6db74">&#34;</span>)
<span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;</span> ggzh<span style="color:#f92672">.</span>save()
<span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;</span> ggzh<span style="color:#f92672">.</span>id
<span style="color:#ae81ff">1</span>
<span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;</span> ggzh<span style="color:#f92672">.</span>book_name
<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">硅谷之火</span><span style="color:#e6db74">&#39;</span>
<span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;</span> ggzh<span style="color:#f92672">.</span>author
<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">迈克尔.斯韦因</span><span style="color:#e6db74">&#39;</span>
<span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;</span> Books<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>all()
<span style="color:#f92672">&lt;</span>QuerySet [<span style="color:#f92672">&lt;</span>Books: Books object (<span style="color:#ae81ff">1</span>)<span style="color:#f92672">&gt;</span>]<span style="color:#f92672">&gt;</span>
</code></pre></div><p>这里我们看到&lt;QuerySet [&lt;Books: Books object (1)&gt;]&gt;这个并不能让我们知道这个对象的细节，通过修改Books模型来修复这个问题</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">/</span>demo<span style="color:#f92672">/</span>models<span style="color:#f92672">.</span>py

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Books</span>(models<span style="color:#f92672">.</span>Model):
    <span style="color:#75715e"># 书名</span>
    book_name <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>CharField(max_length<span style="color:#f92672">=</span><span style="color:#ae81ff">200</span>)
    <span style="color:#75715e"># 作者</span>
    author <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>CharField(max_length<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>)
    
	<span style="color:#66d9ef">def</span> __str__(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>book_name

</code></pre></div><p>修改完成后重新进入交互终端，再次查询就可以显示书名了，这里可以自己定义想显示的字段或内容</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> python manage<span style="color:#f92672">.</span>py shell
<span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">from</span> demo.models <span style="color:#f92672">import</span> Books
<span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;</span> Books<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>all()
<span style="color:#f92672">&lt;</span>QuerySet [<span style="color:#f92672">&lt;</span>Books: <span style="color:#960050;background-color:#1e0010">硅</span><span style="color:#960050;background-color:#1e0010">谷</span><span style="color:#960050;background-color:#1e0010">之</span><span style="color:#960050;background-color:#1e0010">火</span><span style="color:#f92672">&gt;</span>]<span style="color:#f92672">&gt;</span>
</code></pre></div><p>再添加一本书，聚合函数</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;</span> qbsz <span style="color:#f92672">=</span> Books(book_name<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">史蒂夫*乔布斯传</span><span style="color:#e6db74">&#34;</span>,author<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">沃尔特·艾萨克森</span><span style="color:#e6db74">&#34;</span>)
<span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;</span> qbsz<span style="color:#f92672">.</span>save()
<span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;</span> Books<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>all()
<span style="color:#f92672">&lt;</span>QuerySet [<span style="color:#f92672">&lt;</span>Books: <span style="color:#960050;background-color:#1e0010">硅</span><span style="color:#960050;background-color:#1e0010">谷</span><span style="color:#960050;background-color:#1e0010">之</span><span style="color:#960050;background-color:#1e0010">火</span><span style="color:#f92672">&gt;</span>, <span style="color:#f92672">&lt;</span>Books: <span style="color:#960050;background-color:#1e0010">史</span><span style="color:#960050;background-color:#1e0010">蒂</span><span style="color:#960050;background-color:#1e0010">夫</span><span style="color:#f92672">*</span><span style="color:#960050;background-color:#1e0010">乔</span><span style="color:#960050;background-color:#1e0010">布</span><span style="color:#960050;background-color:#1e0010">斯</span><span style="color:#960050;background-color:#1e0010">传</span><span style="color:#f92672">&gt;</span>]<span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;</span> Books<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>count()
<span style="color:#ae81ff">2</span>
<span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;</span> Books<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>filter(book_name<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">硅谷之火</span><span style="color:#e6db74">&#34;</span>)
<span style="color:#f92672">&lt;</span>QuerySet [<span style="color:#f92672">&lt;</span>Books: <span style="color:#960050;background-color:#1e0010">硅</span><span style="color:#960050;background-color:#1e0010">谷</span><span style="color:#960050;background-color:#1e0010">之</span><span style="color:#960050;background-color:#1e0010">火</span><span style="color:#f92672">&gt;</span>]<span style="color:#f92672">&gt;</span>
</code></pre></div><p>接下来我们将Books模型添加到admin管理，通过register方法，将Books交给admin管理</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">/</span>demo<span style="color:#f92672">/</span>admin

<span style="color:#f92672">from</span> django.contrib <span style="color:#f92672">import</span> admin

<span style="color:#f92672">from</span> .models <span style="color:#f92672">import</span> Books

admin<span style="color:#f92672">.</span>site<span style="color:#f92672">.</span>register(Books)
</code></pre></div><p>重新运行项目，在地址栏输入：http://127.0.0.1:8000/admin/，输入账号密码登录即可查看到这个模型</p>
<p><img src="https://tva4.sinaimg.cn/large/006lmzsGgy1gav1r45uowj31h70s9wfe.jpg" alt=""></p>
<p>点进去可以查看该模型的数据，右上角可以添加，动作可以删除，点图书名可以看到更多细节</p>
<p><img src="https://tvax3.sinaimg.cn/large/006lmzsGgy1gav1rig51bj31hb0s83zk.jpg" alt="后台管理图书"></p>
<h3 id="视图与模板">视图与模板</h3>
<p>在models.py中添加一个图书模型</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">/</span>demo<span style="color:#f92672">/</span>models<span style="color:#f92672">.</span>py

<span style="color:#f92672">from</span> django.db <span style="color:#f92672">import</span> models


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Books</span>(models<span style="color:#f92672">.</span>Model):
    <span style="color:#75715e"># 书名</span>
    name <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>CharField(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">书名</span><span style="color:#e6db74">&#39;</span>, max_length<span style="color:#f92672">=</span><span style="color:#ae81ff">200</span>)
    <span style="color:#75715e"># 作者</span>
    author <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>CharField(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">作者</span><span style="color:#e6db74">&#39;</span>, max_length<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>)
    publish_house <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>CharField(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">出版社</span><span style="color:#e6db74">&#39;</span>, max_length<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>)
    publish_date <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>CharField(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">出版日期</span><span style="color:#e6db74">&#39;</span>, max_length<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>)
    price <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>IntegerField(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">价格</span><span style="color:#e6db74">&#39;</span>)
    synopsis <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>TextField(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">简介</span><span style="color:#e6db74">&#39;</span>)

    <span style="color:#66d9ef">def</span> __str__(self):
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>name
</code></pre></div><p>在admin.py中注册Books</p>
<p>迁移数据库</p>
<p>在Django后台中添加图书数据</p>
<p>在应用的views.py中编写一个展示图书的视图</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">/</span>demo<span style="color:#f92672">/</span>views<span style="color:#f92672">.</span>py

<span style="color:#f92672">from</span> django.http <span style="color:#f92672">import</span> HttpResponse
<span style="color:#f92672">from</span> .models <span style="color:#f92672">import</span> Books


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">book_list</span>(request):
    book_list <span style="color:#f92672">=</span> Books<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>all()
    books <span style="color:#f92672">=</span> {book<span style="color:#f92672">.</span>name: book<span style="color:#f92672">.</span>id <span style="color:#66d9ef">for</span> book <span style="color:#f92672">in</span> book_list}
    <span style="color:#66d9ef">return</span> render(request, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">index.html</span><span style="color:#e6db74">&#39;</span>, context<span style="color:#f92672">=</span>{<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">books</span><span style="color:#e6db74">&#39;</span>: books})
</code></pre></div><p>通过模板渲染</p>
<p>在templates目录下新建一个index.html文件</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">/tempaltes/index.html

<span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
&lt;<span style="color:#f92672">html</span> <span style="color:#a6e22e">lang</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;en&#34;</span>&gt;
&lt;<span style="color:#f92672">head</span>&gt;
    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;
    &lt;<span style="color:#f92672">title</span>&gt;Title&lt;/<span style="color:#f92672">title</span>&gt;
&lt;/<span style="color:#f92672">head</span>&gt;
&lt;<span style="color:#f92672">body</span>&gt;

&lt;<span style="color:#f92672">div</span>&gt;图书管理系统：&lt;/<span style="color:#f92672">div</span>&gt;
&lt;<span style="color:#f92672">ul</span>&gt;
    {% for key,value in books.items  %}
        &lt;<span style="color:#f92672">li</span>&gt;&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{% url &#39;detail&#39; value %}/&#34;</span>&gt;{{ key }}&lt;/<span style="color:#f92672">a</span>&gt; &lt;/<span style="color:#f92672">li</span>&gt;
    {% endfor %}
&lt;/<span style="color:#f92672">ul</span>&gt;
&lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;
</code></pre></div><p>在项目的urls.py文件中添加一个关于图书的路由</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">/</span>mysite<span style="color:#f92672">/</span>urls<span style="color:#f92672">.</span>py

<span style="color:#f92672">from</span> django.contrib <span style="color:#f92672">import</span> admin
<span style="color:#f92672">from</span> django.urls <span style="color:#f92672">import</span> path

<span style="color:#f92672">from</span> demo <span style="color:#f92672">import</span> views

urlpatterns <span style="color:#f92672">=</span> [
    path(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">admin/</span><span style="color:#e6db74">&#39;</span>, admin<span style="color:#f92672">.</span>site<span style="color:#f92672">.</span>urls),
    path(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">book/</span><span style="color:#e6db74">&#39;</span>, include(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">demo.urls</span><span style="color:#e6db74">&#39;</span>)),
]
</code></pre></div><p>在demo目录中新建一个urls.py文件，并添加一个路由</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">/</span>demo<span style="color:#f92672">/</span>urls<span style="color:#f92672">.</span>py

<span style="color:#f92672">from</span> django.urls <span style="color:#f92672">import</span> path

<span style="color:#f92672">from</span> . <span style="color:#f92672">import</span> views

urlpatterns <span style="color:#f92672">=</span> [
    path(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>, views<span style="color:#f92672">.</span>book_list, name<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">index</span><span style="color:#e6db74">&#39;</span>),
]

</code></pre></div><p>启动项目，访问：http://127.0.0.1:8000/book/</p>
<p>图书列表页完成了，接下来编写图书详情页</p>
<p>在demo项目中的urls.py文件中添加一个详情页的路由</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">/</span>demo<span style="color:#f92672">/</span>urls<span style="color:#f92672">.</span>py

<span style="color:#f92672">from</span> django.urls <span style="color:#f92672">import</span> path

<span style="color:#f92672">from</span> . <span style="color:#f92672">import</span> views

urlpatterns <span style="color:#f92672">=</span> [
    path(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>, views<span style="color:#f92672">.</span>book_list, name<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">index</span><span style="color:#e6db74">&#39;</span>),
    path(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&lt;int:id&gt;/</span><span style="color:#e6db74">&#39;</span>, views<span style="color:#f92672">.</span>detail, name<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">detail</span><span style="color:#e6db74">&#39;</span>),
]
</code></pre></div><p>在demo项目中的views.py文件中编写详情页相关视图函数</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">/</span>demo<span style="color:#f92672">/</span>views<span style="color:#f92672">.</span>py

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">detail</span>(request, id):
    book <span style="color:#f92672">=</span> Books<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>filter(id<span style="color:#f92672">=</span>id)<span style="color:#f92672">.</span>all()[<span style="color:#ae81ff">0</span>]
    content <span style="color:#f92672">=</span> {
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">name</span><span style="color:#e6db74">&#34;</span>: book<span style="color:#f92672">.</span>name,
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">author</span><span style="color:#e6db74">&#34;</span>: book<span style="color:#f92672">.</span>author,
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">publish_house</span><span style="color:#e6db74">&#39;</span>: book<span style="color:#f92672">.</span>publish_house,
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">publish_date</span><span style="color:#e6db74">&#39;</span>: book<span style="color:#f92672">.</span>publish_date,
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">price</span><span style="color:#e6db74">&#39;</span>: book<span style="color:#f92672">.</span>price,
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">synopsis</span><span style="color:#e6db74">&#39;</span>: book<span style="color:#f92672">.</span>synopsis
    }
    <span style="color:#66d9ef">return</span> render(request, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">detail.html</span><span style="color:#e6db74">&#39;</span>, context<span style="color:#f92672">=</span>content)
</code></pre></div><p>在templates文件夹里新建一个detail.html文件,并写入一下代码</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">/templates/detail.html

<span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
&lt;<span style="color:#f92672">html</span> <span style="color:#a6e22e">lang</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;en&#34;</span>&gt;
&lt;<span style="color:#f92672">head</span>&gt;
    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;
    &lt;<span style="color:#f92672">title</span>&gt;Title&lt;/<span style="color:#f92672">title</span>&gt;
&lt;/<span style="color:#f92672">head</span>&gt;
&lt;<span style="color:#f92672">body</span>&gt;
&lt;<span style="color:#f92672">table</span>&gt;
    &lt;<span style="color:#f92672">tr</span>&gt;
        &lt;<span style="color:#f92672">td</span>&gt;书名&lt;/<span style="color:#f92672">td</span>&gt;
        &lt;<span style="color:#f92672">td</span>&gt;作者&lt;/<span style="color:#f92672">td</span>&gt;
        &lt;<span style="color:#f92672">td</span>&gt;出版社&lt;/<span style="color:#f92672">td</span>&gt;
        &lt;<span style="color:#f92672">td</span>&gt;出版日期&lt;/<span style="color:#f92672">td</span>&gt;
        &lt;<span style="color:#f92672">td</span>&gt;价格&lt;/<span style="color:#f92672">td</span>&gt;
        &lt;<span style="color:#f92672">td</span>&gt;简介&lt;/<span style="color:#f92672">td</span>&gt;
    &lt;/<span style="color:#f92672">tr</span>&gt;
    &lt;<span style="color:#f92672">tr</span>&gt;
        &lt;<span style="color:#f92672">td</span>&gt;{{ name }}&lt;/<span style="color:#f92672">td</span>&gt;
        &lt;<span style="color:#f92672">td</span>&gt;{{ author }}&lt;/<span style="color:#f92672">td</span>&gt;
        &lt;<span style="color:#f92672">td</span>&gt;{{ publish_house }}&lt;/<span style="color:#f92672">td</span>&gt;
        &lt;<span style="color:#f92672">td</span>&gt;{{ publish_date }}&lt;/<span style="color:#f92672">td</span>&gt;
        &lt;<span style="color:#f92672">td</span>&gt;{{ price }}&lt;/<span style="color:#f92672">td</span>&gt;
        &lt;<span style="color:#f92672">td</span>&gt;{{ synopsis }}&lt;/<span style="color:#f92672">td</span>&gt;
    &lt;/<span style="color:#f92672">tr</span>&gt;
&lt;/<span style="color:#f92672">table</span>&gt;

&lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;
</code></pre></div><p>启动项目，访问：http://127.0.0.1:8000/book/，点击其中一个图书就可以看到详情页，或者直接选择一个id访问详情页，这时候就会出现一个问题，当访问一个不存在的id时就会出错，我们需要定制一下错误页面，修改detail视图函数。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">/</span>demo<span style="color:#f92672">/</span>views<span style="color:#f92672">.</span>py
<span style="color:#f92672">from</span> django.http <span style="color:#f92672">import</span> Http404
<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">detail</span>(request, id):
    books <span style="color:#f92672">=</span> Books<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>filter(id<span style="color:#f92672">=</span>id)<span style="color:#f92672">.</span>all()
    <span style="color:#66d9ef">if</span> len(books):
        book <span style="color:#f92672">=</span> books[<span style="color:#ae81ff">0</span>]
        content <span style="color:#f92672">=</span> {
            <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">name</span><span style="color:#e6db74">&#34;</span>: book<span style="color:#f92672">.</span>name,
            <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">author</span><span style="color:#e6db74">&#34;</span>: book<span style="color:#f92672">.</span>author,
            <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">publish_house</span><span style="color:#e6db74">&#39;</span>: book<span style="color:#f92672">.</span>publish_house,
            <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">publish_date</span><span style="color:#e6db74">&#39;</span>: book<span style="color:#f92672">.</span>publish_date,
            <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">price</span><span style="color:#e6db74">&#39;</span>: book<span style="color:#f92672">.</span>price,
            <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">synopsis</span><span style="color:#e6db74">&#39;</span>: book<span style="color:#f92672">.</span>synopsis
        }
        <span style="color:#66d9ef">return</span> render(request, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">detail.html</span><span style="color:#e6db74">&#39;</span>, context<span style="color:#f92672">=</span>content)
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">raise</span> Http404(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">图书不存在</span><span style="color:#e6db74">&#34;</span>)
</code></pre></div><p>这里调用的是Django自带的404错误页面，我们需要返回错误说明</p>

    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>SilenceHL </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=http://49.235.231.121/2019/django%E5%88%9D%E4%BD%93%E9%AA%8C/>http://49.235.231.121/2019/django%E5%88%9D%E4%BD%93%E9%AA%8C/</span>
            </p>
            
             
            <p class="copyright-item lincese">
                本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s): 
            
            <span class="tag"><a href="http://49.235.231.121/tags/django2.x/">
                    #Django2.x</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="http://49.235.231.121/">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="http://49.235.231.121/2019/%E8%AE%B0django2.x%E9%85%8D%E7%BD%AEmysql/" class="prev" rel="prev" title="Django2.x配置mysql"><i class="iconfont icon-left"></i>&nbsp;Django2.x配置mysql</a>
         
        
        <a href="http://49.235.231.121/2019/django2.0%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/" class="next" rel="next" title="Django2.x搭建博客">Django2.x搭建博客&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
	    
             
             

<div id="vcomments"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>

<script type="text/javascript">
  new Valine({
      el: '#vcomments' ,
      appId: 'CPUadU9FrUpQzf7dYqNF9gbT-gzGzoHsz',
      appKey: 'fsddpUyXPG7Nsn65o5bdydWH',
      notify: 'true', 
      verify: 'false', 
      avatar:'mp', 
      placeholder: '说点什么吧...(邮箱不会显示,有回复可以收到提醒邮件!)',
      visitor: 'true'
  });
</script>

       
    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2019 - 2020</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="http://49.235.231.121/">SilenceHL</a> | </span> 
         

         
		  <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://github.com/liuzc/leaveit" target="_blank" rel="external nofollow">LeaveIt</a></span> 
    </div>
</footer>













    
     <link href="https://cdn.bootcss.com/lightgallery/1.6.11/css/lg-fb-comment-box.min.css" rel="stylesheet">  
      
     <script src="/js/vendor_gallery.min.js" async="" ></script>
    
  



     </div>
  </body>
</html>
